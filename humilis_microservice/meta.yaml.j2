---
meta:
    description:
        AWS Lambda microservice

    parameters:
        dynamodb_capacity:
            description:
                The read and write capacity for the Lambda state table(s).
            value:
                read: 5
                write: 5

        rest_api_id:
            description:
                The ID of the REST API that will hold this microservice.
            value:

        parent_resource_id:
            description:
                The resource ID of the parent of all resources in this microservice.
            value:

        variables:
            description:
                The environment variables that will be injected in all the AWS
                Lambdas that back the API resources.
            value: {}

        lambda_environment:
            description:
                Deprecated. Use 'variables' instead.
            value: {}

        api_resources:
            value:
                {% for resource in resources %}
                -
                  {% if resource.path %}
                  path: {{resource.path}}
                  {% endif %}
                  {% if resource.variables or resource.lambda_environment %}
                  lambda_environment: {{resource.variables or resource.lambda_environment}}
                  {% endif %}
                  lambda_function:
                    $lambda:
                        path: lambda_function
                        dependencies: {{resource.lambda_dependencies}}
                        handler: {{resource.handler}}
                {% endfor %}
